# Приложение для ETL процесса

## Описание скриптов из py_scripts

### `read_data` - чтение данных из файлов 

1. список транзакций за текущий день. Формат – CSV.

2. список терминалов полным срезом. Формат – XLSX.

3. список паспортов, включенных в «черный список» - с накоплением с начала месяца. Формат – XLSX.

### `update_st_tables` - очищение стейджинговых таблиц и заполнение новыми данными

### `st_tables` - чтение данных из стейджинговых таблиц 

### `dwh_fact` - заполнение фактовых таблиц

### `dwh_dim_hist` - заполнение таблиц размерностей по форме SCD2

### `fraud_operations` - определение мошеннических операций следующих 4-х типов:

1. совершение операции при просроченном или заблокированном паспорте.

2. совершение операции при не действующем договоре.

3. совершение операций в разных городах в течение одного часа.

4. попытка подбора суммы: в течение 20 минут проходит более 3х операций со следующим шаблоном – каждая последующая меньше предыдущей, при этом отклонены все кроме последней, последняя операция (успешная) в такой цепочке считается мошеннической.


### `report` - подготовка отчета и запись результатов в следующем виде:

*event_dt*  - время наступления события, если событие наступило по результату нескольких действий – указывается время действия, по которому установлен факт мошенничества

*passport* - номер паспорта клиента, совершившего мошенническую операцию

*fio* - ФИО клиента, совершившего мошенническую операцию

*phone* - номер телефона клиента, совершившего мошенническую операцию

*event_type* - описание типа мошенничества (номер)

*report_dt* - дата, на которую построен отчет.

## Описание основных скриптов
### `main.py` - скрипт, выполняющий все этапы ETL.
### `main.cron` - запуск ETL процесса согласно расписанию один раз в день в 23:59.

